using Components.ConsolePlus;
using Components.MicroScript.Interpreter;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace PhpVH
{
    public static class ScriptLauncher
    {
        public static MicroScriptObject Execute(string filename)
        {
            var interpreter = new MicroScriptInterpreter();
            Cli.WriteLine("Executing ~Cyan~{0}~R~", filename);
            interpreter.InterpretFile(filename);
            return interpreter.GetReturnValue();
        }

        public static string[] LoadTestCases(string filename)
        {
            var obj = ScriptLauncher.Execute(filename);
            var testCases = MicroScriptObjectConverter.ToStringArray(obj);
            Cli.WriteLine("~Green~{0}~R~ test cases loaded", testCases.Length);
            return testCases;
        }
    }
}

using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Xml.Serialization;

namespace PhpVH.CodeCoverage
{
    [Serializable]
    public class AnnotationTable : List<AnnotationList>
    {
        [XmlIgnore]
        public AnnotationList this[string filename]
        {
            get { return this.FirstOrDefault(x => x.Filename == filename); }
            set
            {
                if (!this.Any(x => x.Filename == filename))
                {
                    Add(new AnnotationList(filename));
                }
                else
                {
                    throw new InvalidOperationException(
                        string.Format("{0} already exists in table", filename));
                }
            }
        }

        public void Add(string filename)
        {
            this[filename] = new AnnotationList(filename);
        }
    }
}

using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using PhpVH.LexicalAnalysis;

namespace PhpVH.CodeAnalysis
{
    public class SwitchStatementAnalyzer : ExpressionAnalyzer
    {
        protected override void AnalyzeCore(Token token)
        {
            if (token.TokenType == TokenType.WhiteSpace ||
                token.TokenType == TokenType.Comment)
            {
                return;
            }
            else if (State == 0 && token.TokenType == TokenType.switchKeyword)
            {
                State++;
            }
            else if (State == 1 && token.TokenType == TokenType.LeftParenthesis)
            {
                State++;
            }
            else if (State == 2 &&
                token.TokenType == TokenType.Variable &&
                Php.Superglobals.Contains(token.Lexeme))
            {
                AddExpressionToken();
            }
            else if (State == 3 && token.TokenType == TokenType.LeftBracket)
            {
                State++;
            }
            else if (State == 4 && token.TokenType == TokenType.String)
            {
                AddExpressionToken();
            }
            else if (State == 5 && token.TokenType == TokenType.RightBracket)
            {
                State++;
            }
            else if (State == 6 && token.TokenType == TokenType.RightParenthesis)
            {
                State++;
            }
            else if (State == 7)
            {
                if (token.TokenType == TokenType.RightBrace)
                {
                    AddExpression();
                }
                else if (token.TokenType == TokenType.caseKeyword)
                {
                    State++;
                }
            }
            else if (State == 8)
            {
                if (token.TokenType == TokenType.String)
                {
                    AddExpressionToken();
                }

                State = 7;
            }
            else
            {
                NewExpression();
            }
        }
    }
}

using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using PhpVH.CodeAnalysis;

namespace PhpVH.ScanPlugins
{
    public abstract class ScanPluginBase
    {
        protected RequestBuilder _requestBuilder = new RequestBuilder(new TracedFunctionCall[0], SuperGlobalValueCollector.Current.PageTable);

        public abstract int ModeCount { get; }

        public abstract string Server { get; set; }

        public abstract string BuildRequest(int Mode, string TargetFile, FileTrace SourceTrace);

        protected abstract ScanAlert ScanTraceCore(FileTrace TargetTrace);

        public ScanAlert ScanTrace(FileTrace targetTrace)
        {
            _requestBuilder = new RequestBuilder(targetTrace.Calls, SuperGlobalValueCollector.Current.PageTable);

            return ScanTraceCore(targetTrace);
        }

        public virtual void Initialize() { }

        public virtual void Uninitialize() { }        
    }    
}
